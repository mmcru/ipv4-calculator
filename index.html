<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="author" content="matt crupi">

    <title>IPv4 Calculator</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/custom.css" rel="stylesheet">

</head>

<body>
	<h3>IPv4 Calculator</h3>
	<h5>Enter an IPv4 address.  (xxx.xxx.xxx.xxx/xx)</h5>
	<form class="form-container">
		<div class="form-group">
			<label>IPv4 Address:  </label>
			<input title="XXX.XXX.XXX.XXX/XX" name="IPv4" id="ipinput" type="text" required pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/(?:\d|[12]\d|3[01])$">
		</div>
	</form>
	<table class="table table-bordered table-hover">
		<tr><td>Subnet Mask:  </td><td id="subnetmask"></td></tr>
		<tr><td>Subnet Bits:  </td><td id="subnetbits"></td></tr>
		<tr><td>Addresses Per Subnet:  </td><td id="addpersubnet"></td></tr>
		<tr><td>Hosts Per Subnet:  </td><td id="hostpersubnet"></td></tr>
		<tr><td>IP Address Class:  </td><td id="ipclass"></td></tr>
	</table>


    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <!-- <script src="js/bootstrap.min.js"></script> -->

	<script>
	$(document).ready(function(){

    $("#idinput").empty();

		var noSubnet = new RegExp(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/);
		var withSubnet = new RegExp(/((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}\/(?:\d|[12]\d|3[01])$/);
		$("#ipinput").on('input', function() {

      //handle class field
			var firstoctet = parseInt($("#ipinput").val().split(".")[0], 10);
			if (firstoctet >= 0 && firstoctet <= 255){
				if (firstoctet >= 240){
					$("#ipclass").text("E")
				};
        if (firstoctet >= 224 && firstoctet <= 239){
          $("#ipclass").text("D")
        };
        if (firstoctet >= 192 && firstoctet <= 223){
          $("#ipclass").text("C")
        };
        if (firstoctet >= 128 && firstoctet <= 191){
          $("#ipclass").text("B")
        };
        if (firstoctet >= 0 && firstoctet <= 127){
          $("#ipclass").text("A")
        };
			};

      //check if match with subnet notation
			if(withSubnet.test($("#ipinput").val())){
        var cidr = parseInt($("#ipinput").val().split("/")[1], 10);
        var remainingbits = (32 - cidr);
        var addresscount = (Math.pow(2, remainingbits));
        $("#subnetbits").text(cidr);
        $("#addpersubnet").text(addresscount);
		$("#hostpersubnet").text(addresscount - 2);


        //calculations based on cidr
        if (cidr == "32"){
          $("#subnetmask").text("255.255.255.255")
        };
        if (cidr == "31"){
          $("#subnetmask").text("255.255.255.254")
        };
        if (cidr == "30"){
          $("#subnetmask").text("255.255.255.252")
        };
        if (cidr == "29"){
          $("#subnetmask").text("255.255.255.248")
        };
        if (cidr == "28"){
          $("#subnetmask").text("255.255.255.240")
        };
        if (cidr == "27"){
          $("#subnetmask").text("255.255.255.224")
        };
        if (cidr == "26"){
          $("#subnetmask").text("255.255.255.192")
        };
        if (cidr == "25"){
          $("#subnetmask").text("255.255.255.128")
        };
        if (cidr == "24"){
          $("#subnetmask").text("255.255.255.0")
        };
        if (cidr == "23"){
          $("#subnetmask").text("255.255.254.0")
        };
        if (cidr == "22"){
          $("#subnetmask").text("255.255.252.0")
        };
        if (cidr == "21"){
          $("#subnetmask").text("255.255.248.0")
        };
        if (cidr == "20"){
          $("#subnetmask").text("255.255.240.0")
        };
        if (cidr == "19"){
          $("#subnetmask").text("255.255.224.0")
        };
        if (cidr == "18"){
          $("#subnetmask").text("255.255.192.0")
        };
        if (cidr == "17"){
          $("#subnetmask").text("255.255.128.0")
        };
        if (cidr == "16"){
          $("#subnetmask").text("255.255.0.0")
        };
        if (cidr == "15"){
          $("#subnetmask").text("255.254.0.0")
        };
        if (cidr == "14"){
          $("#subnetmask").text("255.252.0.0")
        };
        if (cidr == "13"){
          $("#subnetmask").text("255.248.0.0")
        };
        if (cidr == "12"){
          $("#subnetmask").text("255.240.0.0")
        };
        if (cidr == "11"){
          $("#subnetmask").text("255.224.0.0")
        };
        if (cidr == "10"){
          $("#subnetmask").text("255.192.0.0")
        };
        if (cidr == "9"){
          $("#subnetmask").text("255.128.0.0")
        };
        if (cidr == "8"){
          $("#subnetmask").text("255.0.0.0")
        };
        if (cidr == "7"){
          $("#subnetmask").text("254.0.0.0")
        };
        if (cidr == "6"){
          $("#subnetmask").text("252.0.0.0")
        };
        if (cidr == "5"){
          $("#subnetmask").text("248.0.0.0")
        };
        if (cidr == "4"){
          $("#subnetmask").text("240.0.0.0")
        };
        if (cidr == "3"){
          $("#subnetmask").text("224.0.0.0")
        };
        if (cidr == "2"){
          $("#subnetmask").text("192.0.0.0")
        };
        if (cidr == "1"){
          $("#subnetmask").text("128.0.0.0")
        };
        if (cidr == "0"){
          $("#subnetmask").text("0.0.0.0")
        };
			}
			else{
				console.log("no match");
			}
		})
	});
	</script>

</body>

</html>
